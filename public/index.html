<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#">
  <head>
    <title>Housing Assistance Toolkit - Boston.gov</title>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <meta charset="utf-8" />
<noscript><meta http-equiv="Refresh" content="0; URL=/big_pipe/no-js?destination=/government/cabinets/economic-opportunity-and-inclusion" />
</noscript><meta name="description" content="We aim to make Boston a global model of economic equity for working people, entrepreneurs, businesses, and investors. Our goal is to enhance the efficiency and effectiveness of government, the quality of life for all Bostonians, and the experience of all visitors. We do this by:" />
<link rel="canonical" href="https://www.boston.gov/government/cabinets/economic-opportunity-and-inclusion" />
<link rel="shortlink" href="https://www.boston.gov/node/2006" />
<meta name="generator" content="Drupal 10 (http://drupal.org)" />
<link rel="apple-touch-icon" sizes="180x180" href="/themes/custom/bos_theme/images/apple-touch-icon.png" />
<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/themes/custom/bos_theme/images/apple-touch-icon-precomposed.png" />
<meta property="og:site_name" content="Boston.gov" />
<meta property="og:url" content="https://www.boston.gov/government/cabinets/economic-opportunity-and-inclusion" />
<meta property="og:title" content="Economic Opportunity and Inclusion" />
<meta property="og:description" content="We aim to make Boston a global model of economic equity for working people, entrepreneurs, businesses, and investors. Our goal is to enhance the efficiency and effectiveness of government, the quality of life for all Bostonians, and the experience of all visitors. We do this by:" />
<meta property="og:image" content="https://patterns.boston.gov/images/global/icons/seal_dark_1000x1000.png" />
<meta property="og:updated_time" content="2025-01-08T13:33:45-0500" />
<meta property="article:published_time" content="2019-11-22T20:26:44-0500" />
<meta property="article:modified_time" content="2025-01-08T13:33:45-0500" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="We aim to make Boston a global model of economic equity for working people, entrepreneurs, businesses, and investors. Our goal is to enhance the efficiency and effectiveness of government, the quality of life for all Bostonians, and the experience of all visitors. We do this by:" />
<meta name="twitter:title" content="Economic Opportunity and Inclusion" />
<meta name="twitter:site" content="@CityOfBoston" />
<meta name="twitter:site:id" content="124455872" />
<meta name="twitter:creator" content="@CityOfBoston" />
<meta name="twitter:creator:id" content="124455872" />
<meta name="Generator" content="Drupal 10 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta class="swiftype" name="site-priority" data-type="integer" content="5" />
<meta class="swiftype" name="type" data-type="enum" content="department_profile" />
<link rel="icon" href="/themes/custom/bos_theme/images/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="alternate" hreflang="und" href="https://www.boston.gov/government/cabinets/economic-opportunity-and-inclusion" />

<link rel="stylesheet" media="all" href="/sites/default/files/css/css_0l0yFwp_LfMFqhGCjQGapZRbfCbhPsalp1O59M9xIKk.css?delta=0&amp;language=en&amp;theme=bos_theme&amp;include=eJxlUNFuxCAM-6EefBIKkFLUlCAStt3fr2XX9ra9RI5t2VE8i_PZe8ps_Y1dEJmOPfBWuWBRsRd0uuCGRvRJ-Nc0Z6T4Js2I0UNY3cxts_8Y54nDOpyC0MJipeRaUc3P6nxX5TIMil9qT3AdOG6xidgDPY7eXJKpoIqtvDsqJDQggvpiGxQhULS_tpEbuBwdHcjG1iuQuZnHXrAeloanGDMQp6lCg9SgLnIKN2N6qX1_rCwYp8p0BR_4FSlPUdx_BILTR8ZPsWOajWMn_AblA6eB" />
<link rel="stylesheet" media="all" href="https://patterns.boston.gov/css/public.css?abc" />

<link rel="stylesheet" media="all" href="/sites/default/files/css/css_MdQDKS2Xx6IYoFnrAGUjFp79Fx5W__Lp43aSkq3nGgQ.css?delta=3&amp;language=en&amp;theme=bos_theme&amp;include=eJxlUNFuxCAM-6EefBIKkFLUlCAStt3fr2XX9ra9RI5t2VE8i_PZe8ps_Y1dEJmOPfBWuWBRsRd0uuCGRvRJ-Nc0Z6T4Js2I0UNY3cxts_8Y54nDOpyC0MJipeRaUc3P6nxX5TIMil9qT3AdOG6xidgDPY7eXJKpoIqtvDsqJDQggvpiGxQhULS_tpEbuBwdHcjG1iuQuZnHXrAeloanGDMQp6lCg9SgLnIKN2N6qX1_rCwYp8p0BR_4FSlPUdx_BILTR8ZPsWOajWMn_AblA6eB" />
<script src="/sites/default/files/js/js_IIIPmvRSCgaCGpVxVqyU6u2qhdaaicCpwho2FNbbM5o.js?scope=header&amp;delta=0&amp;language=en&amp;theme=bos_theme&amp;include=eJx9kF1ywzAIhC8US0fSIBsrJAg0gkzi29exk9b9mb7A7n7AA5lKatQw5pc4ZbWUKWcmjQedLrYhmjtUjF_yDQyhj-c4LQKVxoEVJuxHYkKtoYfdpnxzV9kG_IzryVHF8eGJSa6HeGZEH0atTQXFLTRwxy52mCmsGXgwX9blEoDvsPzD_7jQoGAAM_RfKcmzpYpy21EHMQbfn_Dpnn8oqoUxOZRY1vLTB7jA43tYT3fMs_YaXz1MBKzlA1PrnxE"></script>
<script src="gtag.js"></script>
<script src="gtm.js"></script>

  </head>
  <body class="html bos_theme not-front not-logged-in node-published page-node-2006 page-node node-type-department-profile">

    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TKGRDS"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    
<input type="checkbox" id="brg-tr" class="brg-tr" aria-hidden="true" />

<!-- ADA Skip Nav -->
<div class="sw-skipnav-outerbar">
  <a href="#content" id="skipLink" class="sw-skipnav" data-swiftype-index="false" tabindex="0" >Skip to Main Content</a>
</div>




      <nav class="nv-m">
  <div class="nv-m-h">
    <div class="nv-m-h-ic">
      <a href="/" title="Go to home page">
        <img src="https://patterns.boston.gov/images/b-dark.svg" alt="City of Boston" aria-hidden="true" class="nv-m-h-i" />
      </a>
    </div>
    <div id="nv-m-h-t" class="nv-m-h-t">&nbsp;</div>
  </div>
  <div class="nv-m-c">
    <nav role="navigation" aria-labelledby="block-mainmenu-menu" id="block-mainmenu" data-block-plugin-id="menu_block:main">
            
  <div class="visually-hidden" id="block-mainmenu-menu">Main menu</div>

    

        

                            <ul class="nv-m-c-l">
                                                                  <li class="nv-m-c-l-i is-l leaf first menu-mlid-763366 nv-m-c-a--y">
                            <a href="https://www.boston.gov/departments/boston-311" class="nv-m-c-a mv-m-c-a--p three-one-one">Help / 311</a>
                            </li>
                                                                      <li class="nv-m-c-l-i is-l leaf menu-mlid-210101">
                            <a href="/homepage-bostongov" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/21">Home</a>
                            </li>
                                                                      <li class="nv-m-c-l-i is-l leaf menu-mlid-171721">
                            <a href="/guides" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/841">Guides to Boston</a>
                            </li>
                                                                      <li class="nv-m-c-l-i is-l leaf menu-mlid-171726">
                            <a href="/departments" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/1796">Departments</a>
                            </li>
                                                                      <li class="nv-m-c-l-i is-l leaf menu-mlid-1675906">
                            <a href="/public-notices" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/11666">Public Notices</a>
                            </li>
                                                                      <li class="nv-m-c-l-i is-l leaf menu-mlid-2354776">
                            <a href="/city-boston-services-applications-and-permits" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/32906">Pay and apply</a>
                            </li>
                                                                      <li class="nv-m-c-l-i is-l leaf menu-mlid-2354781">
                            <a href="/career-center" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/19261">Jobs and careers</a>
                            </li>
                                                                      <li class="nv-m-c-l-i is-l leaf menu-mlid-2356726">
                            <a href="https://www.boston.gov/government/cabinets/economic-opportunity-and-inclusion" class="nv-m-c-a mv-m-c-a--p">Business Support</a>
                            </li>
                                                                      <li class="nv-m-c-l-i is-l leaf menu-mlid-885866">
                            <a href="/events" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/1426">Events</a>
                            </li>
                                                                      <li class="nv-m-c-l-i is-l leaf menu-mlid-202946">
                            <a href="/news" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/1401">News</a>
                            </li>
                                                          <li class="nv-m-c-l-i is-e expanded menu-mlid-171731">
                <a href="#" title="Click to expand Places menu" class="nv-m-c-a mv-m-c-a--p nolink nolink--a ">Places</a>
                                                              <ul class="nv-m-c-l-l">
            <li class="nv-m-c-bc"><button class="nv-m-c-b">Back</button></li>
                                                                  <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="/cemeteries" title="" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/33006">Cemeteries</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="/community-centers" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/32886">Community centers</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="https://www.boston.gov/departments/landmarks-commission#historic-districts" title="" class="nv-m-c-a mv-m-c-a--p">Historic Districts</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="https://www.bpl.org/" title="" class="nv-m-c-a mv-m-c-a--p">Libraries</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="/neighborhoods" title="" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/33066">Neighborhoods</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="/departments/parks-and-recreation/popular-playgrounds-and-parks-boston" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/3871">Parks and playgrounds</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="http://www.bostonpublicschools.org/Page/628" title="" class="nv-m-c-a mv-m-c-a--p">Schools</a>
                            </li>
                            </ul>
    
                              </li>
                                                          <li class="nv-m-c-l-i is-e expanded menu-mlid-171741">
                <a href="#" title="Click to expand Government menu" class="nv-m-c-a mv-m-c-a--p nolink nolink--a ">Government</a>
                                                              <ul class="nv-m-c-l-l">
            <li class="nv-m-c-bc"><button class="nv-m-c-b">Back</button></li>
                                                                  <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="/departments/mayors-office" title="" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/176">The Mayor&#039;s Office</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="/departments/city-clerk" title="" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/136">City Clerk</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="https://www.boston.gov/departments/city-council" class="nv-m-c-a mv-m-c-a--p">City Council</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="/departments/election" title="" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/131">Elections</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="https://www.boston.gov/civic-engagement/boards-and-commissions" title="" class="nv-m-c-a mv-m-c-a--p">Boards and commissions</a>
                            </li>
                                                                      <li class="nv-m-c-l-l-i is-l leaf ">
                            <a href="/departments/311/city-boston-government" class="nv-m-c-a mv-m-c-a--p" data-drupal-link-system-path="node/28101">City government overview</a>
                            </li>
                            </ul>
    
                              </li>
                                                                      <li class="nv-m-c-l-i is-l leaf menu-mlid-2356706 last">
                            <a href="mailto:mayor24reply@boston.gov" title="Need help? You can send an email to BOS:311 for non-emergency services through the feedback form below." class="nv-m-c-a mv-m-c-a--p">Feedback</a>
                            </li>
                            </ul>
    


  </nav>


  </div>
</nav>

<div id="page" class="mn page--wa" data-target="2006">
  <input type="checkbox" id="s-tr" class="s-tr" aria-hidden="true">

  <header id="main-menu" class="h" role="banner" data-swiftype-index="false">
    <label for="brg-tr" class="brg-b" tabindex="0">
  <span class="brg">
    <span class="brg-c">
      <span class="brg-c-i"></span>
    </span>
    <span class="brg-t"><span class="a11y--h">Toggle </span>Menu</span>
  </span>
</label>

          <div class="lo lo--abs">
      <div class="lo-l lo-b-cont">
        <a href="/" id="logoImg">
          <img src="https://patterns.boston.gov/images/public/logo.svg?sq0gla" alt="Boston.gov" class="lo-i" />
        </a>
                  <span class="lo-t"><a href="/mayor">Mayor Michelle Wu</a></span>
              </div>
    </div>

    <a id="seal" href="/" title="Homepage | City of Boston Seal" rel="home" class="s">
  <img src="https://patterns.boston.gov/images/public/seal.svg?sq0gla" alt="City of Boston Seal" class="s-i" />
</a>

    <nav class="nv-h">
    <ul class="nv-h-l">
                    <div id="google_translate_element"></div>

    <script type="text/javascript">
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
        }
    </script>
    <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
        
                    <li class="nv-h-l-i">
                                  <a href="/city-boston-services-applications-and-permits" class="nv-h-l-a" data-drupal-link-system-path="node/32906">Information and Services</a>
                            </li>
                    <li class="nv-h-l-i">
                                  <a href="/public-notices" title="" class="nv-h-l-a" data-drupal-link-system-path="node/11666">Public notices</a>
                            </li>


                    <li class="nv-h-l-i">
                                  <a href="/form/website-feedback-form" class="webform-dialog webform-dialog-narrow nv-h-l-a ">Feedback</a>
                            </li>
                      <li id="targetLanguage" class="nv-h-l-i translate" data-nosnippet>
        </li>
              <li class="nv-h-l-i">
            <label for="s-tr" title="Search" class="nv-h-l-a nv-h-l-a--k nv-h-l-a-ic" id="searchIcon" tabindex="0">
                <svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 41"><title>Search</title>
                    <path class="nv-h-l-a-i"
                          d="M24.2.6C15.8.6 9 7.4 9 15.8c0 3.7 1.4 7.2 3.6 9.8L1.2 37c-.8.8-.8 2 0 2.8.4.4.9.6 1.4.6s1-.2 1.4-.6l11.5-11.5C18 30 21 31 24.2 31c8.4 0 15.2-6.8 15.2-15.2C39.4 7.4 32.6.6 24.2.6zm0 26.5c-6.2 0-11.2-5-11.2-11.2S18 4.6 24.2 4.6s11.2 5 11.2 11.2-5 11.3-11.2 11.3z" />
                </svg>
            </label>
        </li>
          </ul>
</nav>

    <div class="h-s">
  <form class="sf" action="/search" accept-charset="UTF-8" method="get">
    <input name="utf8" type="hidden" value="✓">
    <div class="sf-i">
      <input type="text" name="query" id="query" value="" placeholder="Search…" class="sf-i-f" autocomplete="off">
      <label for="query" class="sf-i-l">Search</label>
      <button class="sf-i-b">Search</button>
    </div>
  </form>
</div>

  </header>
<section>
    <div class="section-content">
        <div class="left-content">
            <h1 class="centered-header">Housing Resource Guide</h1>
            <div class="text-content">
                <p>Welcome to the Housing Assistance Toolkit! Our goal is to provide comprehensive resources to help you navigate housing options in Boston. Whether you are looking for affordable housing, assistance programs, or general information, we are here to assist you.</p>
            </div>
        </div>

        <div class="right-content">
            <img src="flow-chart-header.png" alt="City of Boston flow chart header" class="header-BOS-image">
            <div class="image-links">
                <div class="image-link">
                    <a href="https://www.boston.gov/departments/planning-advisory-council/anti-displacement-action-plan#reports" target="_blank">
                        <img src="foundation-report-cover.jpg" alt="Cover of Foundation Report">
                    </a>
                    <p><a href="https://www.boston.gov/departments/planning-advisory-council/anti-displacement-action-plan#reports" target="_blank">Laying the Foundation: Community Anti-Displacement Priorities</a></p>
                </div>

                <div class="image-link">
                    <a href="https://www.boston.gov/departments/planning-advisory-council/anti-displacement-action-plan#reports" target="_blank">
                        <img src="toolkit-report-cover.jpg" alt="Cover of Toolkit Report">
                    </a>
                    <p><a href="https://www.boston.gov/departments/planning-advisory-council/anti-displacement-action-plan#reports" target="_blank">Anti-Displacement Existing Toolkit and Progress</a></p>
                </div>
            </div>
        </div>
    </div>
</section>


          <div id="sa" class="d--n node-site-alert">
                  <div class="views-element-container" id="block-bos-theme-views-block-site-alerts-block-site-alerts--2" data-block-plugin-id="views_block:site_alerts-block_site_alerts">
      <div><div class="js-view-dom-id-59da6b3b7b5df062dada3c85cca04f8624f82e85e0dc3bb45c76fd33ec0b4267">
  



  <!-- Your main content remains -->
   

  <div class="container">
      <h1>Easily access Anti-Displacement resources with QuickConnect</h1>
      <h2>Finding and keeping a home can be stressful. The City of Boston can help.</h2>
    <div class="role-selection">
      <button id="renterBtn" class="role-btn">I am a Renter</button>
      <button id="homeownerBtn" class="role-btn">I am a Homeowner</button>
    </div>
    
    <!-- Renter Section -->
    <div id="renterSection" class="content-section" style="display: none;">
      <h2>As a Renter, I need to...</h2>
      <div class="accordion"></div>
  </div>

    <!-- Homeowner Section -->
    <div id="homeownerSection" class="content-section" style="display: none;">
      <h2>As a Homeowner, I need to...</h2>
      <div class="accordion"></div>
    </div>
  </div>

  <script src="script.js"></script>

  

    <img 
  id="chatIcon" 
  src="ai_icon_2.png" 
  alt="Chat Icon"
  style="
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 100px;
    height: 100px;
    cursor: pointer;
    z-index: 9999;

    /* Make it circular */
    border-radius: 50%;
    object-fit: cover; 
  "
    />




    
	<div id="chatbotContainer" style="display: none; position: fixed; bottom: 140px; right: 20px; width: 400px; max-width: 90%; z-index: 9998;">

    <script>
    // Grab references to our icon and the chatbot container
    const chatIcon = document.getElementById("chatIcon");
    const chatbotContainer = document.getElementById("chatbotContainer");

    chatIcon.addEventListener("click", () => {
      // If container is hidden, show it; otherwise hide it
      if (chatbotContainer.style.display === "none") {
        chatbotContainer.style.display = "block";
      } else {
        chatbotContainer.style.display = "none";
      }
    });
    </script>
    

  <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" 
        integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" 
        crossorigin="anonymous">

  <!-- Optionally, create your own style overrides for .chat, .msg_card_body, etc. -->
  <style>
    /* Example minimal styling to ensure the chat card doesn't expand full screen. */
    .chat {
      max-height: 500px;
      overflow: auto;
    }
    .card {
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
  </style>

  <div class="container-fluid h-100" style="padding: 0; margin: 0;">
    <div class="row justify-content-center h-100">
      <div class="col-md-12 chat"> <!-- changed from col-md-8 col-xl-6 to col-md-12 -->
        <div class="card">
          <div class="card-header msg_head">
            <div class="d-flex bd-highlight">
              <div class="img_cont">
                <img src="ai_icon.png"
                     class="rounded-circle user_img"
                     style="width: 50px; height: auto;">
                <span class="online_icon"></span>
              </div>
              <div class="user_info" style="padding-left: 10px;">
                <span>The City of Boston</span>
                <p>We are here to help you!</p>
              </div>
              <!-- Optionally add a "close" button in the header -->
              <button id="closeChatbot" class="ml-auto btn btn-sm btn-outline-secondary">
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
          <div id="messageFormeight" class="card-body msg_card_body"></div>
          <div class="card-footer">
            <form id="messageArea" class="input-group">
              <input type="text" id="text" name="msg" placeholder="Type your message..." 
                     autocomplete="off" class="form-control type_msg" required/>
              <div class="input-group-append">
                <button type="submit" id="send" class="input-group-text send_btn">
                  <i class="fas fa-location-arrow"></i>
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Dependencies: jQuery, underscore, backbone, marked -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.13.6/underscore-min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.4.1/backbone-min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- Insert your existing JS script from the chatbot -->
  <script>
    // ------------------------
    //  Backbone Chat Logic
    // ------------------------
    var Message = Backbone.Model.extend({
      defaults: {
        text: '',
        sender: 'user',
        timestamp: ''
      }
    });

    var Messages = Backbone.Collection.extend({
      model: Message
    });

    var MessageView = Backbone.View.extend({
      el: '#messageFormeight',
      initialize: function() {
        this.collection.on('add', this.render, this);
      },
      render: function(model) {
        var str_time = model.get('timestamp');
        var rawText = model.get('text');
        var sender = model.get('sender');

        var renderedHTML = (sender === 'bot') 
            ? marked.parse(rawText)
            : _.escape(rawText);

        var userHtml = '';
        if(sender === 'user') {
          userHtml = `
            <div class="d-flex justify-content-end mb-4">
              <div class="msg_cotainer_send">
                ${renderedHTML}
                <span class="msg_time_send">${str_time}</span>
              </div>
              <div class="img_cont_msg">
                <img src="https://i.ibb.co/xzFcJvX/Asset-1.png"
                     class="rounded-circle user_img_msg"
                     style="width: 20px; height: auto;">
              </div>
            </div>`;
        } else {
          userHtml = `
            <div class="d-flex justify-content-start mb-4">
              <div class="img_cont_msg">
                <img src="ai_icon.png"
                     class="rounded-circle user_img_msg"
                     style="width: 20px; height: auto;">
              </div>
              <div class="msg_cotainer">
                ${renderedHTML}
                <span class="msg_time">${str_time}</span>
              </div>
            </div>`;
        }

        this.$el.append(userHtml);
        return this;
      }
    });

    var messages = new Messages();
    var messageView = new MessageView({ collection: messages });

    var globalThreadId = null;

    $(document).ready(function() {
      // On load, create a new thread
      $.ajax({
        url: '/thread',
        type: 'GET',
        success: function(data) {
          globalThreadId = data.threadId; 
          console.log("Thread created: " + globalThreadId);
        },
        error: function(err) {
          console.error("Error creating thread:", err);
        }
      });

      // Handle user message submit
      $("#messageArea").on("submit", function(event) {
        event.preventDefault();
        var date = new Date();
        var hour = String(date.getHours()).padStart(2, '0');
        var minute = String(date.getMinutes()).padStart(2, '0');
        var str_time = hour + ":" + minute;

        var rawText = $("#text").val().trim();
        if(!rawText) return;

        messages.add(new Message({
          text: rawText,
          sender: 'user',
          timestamp: str_time
        }));

        $("#text").val("");

        // Send to server
        $.ajax({
          url: '/message',
          type: 'POST',
          data: {
            threadId: globalThreadId,
            message: rawText
          },
          success: function(serverData) {
            if (serverData.messages) {
              var latest = serverData.messages[serverData.messages.length - 1];
              messages.add(new Message({
                text: latest,
                sender: 'bot',
                timestamp: str_time
              }));
            } else {
              console.error("Unexpected response:", serverData);
            }
          },
          error: function(err) {
            console.error("Error sending message:", err);
          }
        });
      });

      // Handle close button
      $("#closeChatbot").on("click", function() {
        $("#chatbotContainer").hide();
      });
    });
  </script>



  </body>
  
</html>
